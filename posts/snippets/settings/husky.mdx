---
title: '(husky) Huskyì™€ Lint-stagedë¥¼ ì´ìš©í•œ Lint ìë™í™”'
description: 'huskyì™€ lint-stagedë¥¼ ì´ìš©í•´ì„œ git hookì„ ì ìš©í•˜ê³  lint, prettierë¥¼ ìë™í™” í•˜ëŠ” ë²•ì„ ë°°ì›Œë³´ê² ìŠµë‹ˆë‹¤.'
icon: ''
image: ''
tags:
  - husky
  - lint-staged
  - git hook
draft: false
date: 2023-07-06 18:15:38
---

## Husky

Huskyë€ eslintë‚˜ prettierì™€ ê°™ì€ ì„¤ì •ì„ ìë™í™”ë¥¼ í†µí•´ íŠ¹ì • ìƒí™©ì—ì„œ ë¬´ì¡°ê±´ ì ìš©ì´ ë˜ë„ë¡ ë„ì™€ì£¼ëŠ” ë„êµ¬ì…ë‹ˆë‹¤. ì•„ë¬´ë¦¬ eslint, prettierì™€ ê°™ì€ ê·œì¹™ì„ ì„¤ì •í•´ë„ ì‘ì—…ìê°€ ì‚¬ìš©ì„ í•˜ì§€ ì•Šìœ¼ë©´ ì†Œìš©ì´ ì—†ìŠµë‹ˆë‹¤.

ìš°ë¦¬ëŠ” ì§€ê¸ˆë¶€í„° huskyë¥¼ ì ìš©í•´ì„œ ë‹¤ìŒ ê³¼ì •ì„ ìë™í™” í•  ê²ƒì…ë‹ˆë‹¤.

1. commit ì „ì— prettier formattingì´ ì˜ ì ìš© ë˜ì–´ìˆëŠ”ì§€ ê²€ì‚¬
2. push ì „ì— eslint ê·œì¹™ì´ ì ìš© ë˜ì—ˆëŠ”ì§€ ê²€ì‚¬
   - pass ë˜ì—ˆì„ ë•Œë§Œ push í•˜ë„ë¡ í•¨

### Huskyì˜ ì—­í• 

- git hook ì—­í• 
  - gitì—ì„œ íŠ¹ì • ì´ë²¤íŠ¸ ë°œìƒí•˜ê¸° ì „, í›„ë¡œ íŠ¹ì • hook ë™ì‘ì„ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. (ex. commit, push)
- git hook ì„¤ì •ì€ ê¹Œë‹¤ë¡œìš°ë©° ëª¨ë“  íŒ€ì›ë“¤ì´ ì‚¬ì „ì— repoë¥¼ í´ë¡ ë°›ê³  ë©”ë‰´ì–¼í•˜ê²Œ ì‚¬ì „ ê³¼ì •ì„ ìˆ˜í–‰í•´ì•¼ì§€ë§Œ hookì´ ì‹¤í–‰ë¨ì„ ë³´ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - ì‹¤ìˆ˜ë¡œë¼ë„ ì‚¬ì „ ê³¼ì •ì„ ì‹œí–‰í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ hookì´ ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- í•´ê²°ë²•ì€? **husky**
  - huskyë¥¼ í†µí•´ì„œ pre-commit, pre-push hookì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br />

## Huskyë¥¼ í†µí•œ Git Hook ì ìš©

1. `npm install husky --save-dev`
2. (ì²˜ìŒ husky ì„¸íŒ…í•˜ëŠ” ì‚¬ëŒë§Œ ì‹¤í–‰ í•„ìš”) `npx husky install`

   1. `npx husky install` : huskyì— ë“±ë¡ëœ hookì„ ì‹¤ì œ .gitì— ì ìš©ì‹œí‚¤ê¸° ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸
   2. add postinstall script in package.json

      - ì´í›„ì— clone ë°›ì•„ì„œ ì‚¬ìš©í•˜ëŠ” ì‚¬ëŒë“¤ì€ npm installí›„ì— ìë™ìœ¼ë¡œ `husky install` ì´ ë  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ì„¤ì •ì…ë‹ˆë‹¤.

      ```json
      // package.json

      {
        "scripts": {
          "postinstall": "husky install"
        }
      }
      ```

3. scripts ì„¤ì •

   ```json
   // package.json

   {
     "scripts": {
       "postinstall": "husky install",
       "lint": "eslint src --ext ts,tsx --report-unused-disable-directives --cache",
       "lint-staged": "lint-staged"
     },
     "lint-staged": {
       "**/*.{tsx,ts,jsx,js}": ["prettier --write"]
     }
   }
   ```

4. add pre-commit, pre-push hook

   1. `npx husky add .husky/pre-commit "yarn lint-staged"`
   2. `npx husky add .husky/pre-push "yarn lint"`

      í•´ë‹¹ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´ ë£¨íŠ¸ ìœ„ì¹˜ì— .husky í´ë”ê°€ ìƒì„±ë©ë‹ˆë‹¤.
      ![230706-185053](/posts/husky/230706-185053.png)

5. prettier í¬ë§· ê²€ì‚¬ë¥¼ í•´ì£¼ëŠ” lint-staged ì„¤ì¹˜

- lint-stagedì˜ ì¥ì 
  - í¬ë§·íŒ…ì„ ìˆ˜í–‰ í•œ ë’¤ git add ëª…ë ¹ì–´ë¥¼ ìë™ìœ¼ë¡œ ìˆ˜í–‰ë˜ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - í¬ë§·íŒ…ì„ ì „ì²´ íŒŒì¼ ëŒ€ìƒì´ ì•„ë‹Œ í˜„ì¬ git stageì— ì˜¬ë¼ì˜¨ ë³€ê²½ì‚¬í•­ ëŒ€ìƒìœ¼ë¡œë§Œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
yarn add -D lint-staged
```

6. .gitignoreì— .eslintcache íŒŒì¼ ì¶”ê°€

```
.eslintcache
```

ê¸´ ê³¼ì • ê³ ìƒ ë§ìœ¼ì…¨ìŠµë‹ˆë‹¤! ì´ì œë¶€í„° í˜‘ì—… ë§Œì¡±ë„ ì‘¥ì‘¥ ì˜¬ë¼ê°ˆ ì¼ë§Œ ë‚¨ì•˜ìŠµë‹ˆë‹¤. ğŸ¥³

## Huskyë¥¼ ì ìš©í•´ì„œ commit, push í•˜ê¸°

### 1. commit: ì»¤ë°‹í•  íŒŒì¼ì´ prettierê°€ ì ìš©ì´ ë˜ì—ˆëŠ”ì§€ ê²€ì‚¬í•©ë‹ˆë‹¤.

- ê°•ì œì„±ì€ ì—†ê¸° ë•Œë¬¸ì— ì ìš©ì´ ì•ˆ ë˜ì–´ìˆë”ë¼ë„ commitì€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```bash
git add íŒŒì¼
git commit -m "ë‚´ìš©"
```

![230706-185355](/posts/husky/230706-185355.png)

### 2. push: pushí•  íŒŒì¼ë“¤ì´ eslint ê·œì¹™ì— ì–´ê¸‹ë‚˜ì§€ ì•ŠëŠ”ì§€ ê²€ì‚¬í•©ë‹ˆë‹¤.

- ê°•ì œì„±ì´ ìˆê¸° ë•Œë¬¸ì— ê·œì¹™ì— ì–´ê¸‹ë‚œë‹¤ë©´ pushë¥¼ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

```bash
git push origin main
```

![230706-185406](/posts/husky/230706-185406.png)

(ê·œì¹™ì— ì–´ê¸‹ë‚œ ê²½ìš° ì—ëŸ¬ì™€ ì›Œë‹ì„ í‘œì‹œí•´ì¤ë‹ˆë‹¤.)

## ê³¼ì • ìš”ì•½

1. package.jsonì— ìˆëŠ” â€œpostinstallâ€ë¡œ ì¸í•´ì„œ, yarn installë§Œ í•´ë„ ëª¨ë“  ì‚¬ëŒì´ husky ì„¤ì¹˜ë¥¼ í•˜ê²Œ ë©ë‹ˆë‹¤.
2. pre-commit git hookì´ ì ìš©ë˜ì–´ì„œ commit í•  ë•Œ package.jsonì— ìˆëŠ” â€œlint-stagedâ€ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤. ì´ê²ƒì€ prettier í¬ë§¤íŒ…ì„ ê²€ì‚¬í•©ë‹ˆë‹¤.
3. pre-push git hookì´ ì ìš©ë˜ì–´ì„œ push í•  ë•Œ package.jsonì— ìˆëŠ” â€œlintâ€ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤. ì´ ë•Œ commitê³¼ ë‹¤ë¥´ê²Œ lint ê·œì¹™ì´ ë§ì§€ ì•Šìœ¼ë©´ pushê°€ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. **(ê°•ì œì„±)**
